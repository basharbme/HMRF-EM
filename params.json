{
  "name": "HMRF-EM",
  "tagline": "A MATLAB implementation of a Hidden Markov Random Field Model (HMRF) optimized with Expectation Maximization used to segment 3D MR images from the OASIS-brains dataset. ",
  "body": "## Segmentation of 3D images using the Hidden Markov Random Field Model (HMRF) and Expectation-Maximization Algorithm (EM)\r\nA MATLAB implementation of the HMRF as described in \"Segmentation of Brain MR Images Through a Hidden Markov Random Field Model and the Expectation-Maximization Algorithm\" [8]. The HMRF is applied to segment images from the cross-sectional OASIS-brains dataset but the code provided can be modified for any 3D image segmentation.\r\n\r\nIn the next couple of sections, I'll introduce the problem of tissue segmentation and classification in medical imaging, desribe the high level segmentation pipeline, mathematical modelling of the HMRF, the optimization through EM, as well as an implementation of the model applied to white matter, grey matter, and cerebrospinal fluid (CSF). If you're not interested in this long discussion and are looking for a quick read about the HMRF model, what my code does, and what can use this code for, skip to the end of this page to \"The HMRF 101\" section.\r\n\r\n## The HMRF 101\r\n### What is a MRF and why would I need one?\r\nGreat question! Before we talk about HMRF's, we need to take a few steps back and talk about Markov Random Fields (MRF's). MRFs are a powerful statistical tool that are exploited in image segmentation applications to provide spatial context into generative models. Work prior to Zhang et al. in 2001 used MRFs as priors in finite mixture models that model tissue intensities (ie. GMM's) or in non-parametric models (ie. Parzen Windows). However, the simplifications made in these models come from mathematical convenience, as opposed to a statistical foundation. Using a HMRF to explicitly model the tissue intensities avoids these assumptions since the spatial relationships are built into the model. The paper ([8]) is a landmark in the field of brain tissue segmentation, but the model can be extended across any domain where capturing local spatial relationships is important to the segmentation task.\r\n\r\n### What can I test this algorithm on?\r\nShort answer - any 3D image. I validated the model using the OASIS- Cross-sectional dataset. This dataset consists of 416 normal and early onset Alzheimer Disease subjects from ages 18-96. Ground truth labels are provided in the dataset - which come from the FAST-FSL implementation of the HMRF described in the paper. This \r\n\r\n### What does my code do?\r\n1. Obtain an initial estimate of the HMRF parameters from an initial segmentation (Otsu or Kmeans).\r\n2. Calculate likelihood distribution of the intensity data given the bias field and the initial tissue classification.\r\n3. Obtain tissue class estimates using MRF-MAP criteria (using the ICM algorithm).\r\n4. Calculate the conditional probability distribution of each class given the intensity values of that class.\r\n5. Update the HMRF parameters for each class.\r\n6. Repeat steps 2-5 until convergence.\r\n\r\n### Authors and Contributors\r\nTanya Nair (@tanyanair)\r\n\r\n### References\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}